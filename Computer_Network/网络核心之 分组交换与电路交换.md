## 网络核心之 分组交换与电路交换

> 网络核心即互联网端系统分组交换机和通信链路构成的网状网络。
>
> 通过该网状网络移动数据的两种基本方法： **分组交换**、**电路交换**。

#### 分组交换 

在各种网络应用中，端系统彼此交换**报文**(message)。

为了从源端系统向目的地系统发送一个报文，将长报文划分成小的数据块，就是**分组**(packet)。

源和目的地之间，通过**通信链路**和**分组交换机**（路由器(router)和链路层交换机(link-layer switch)）传送。

![image.png](http://ww1.sinaimg.cn/large/00882iMuly1geeibl726lj30jh06rt9q.jpg)

##### 1. 存储转发传输

> 存储转发传输(store-and-forward transmission)指在交换机能够开始向输出链路传输该分组的第一个比特之前，**必须收到整个分组**，就是一家人哦都要整整齐齐吧，将已经接受到的比特缓存着，待全部到齐，才开始传输。

##### 2.排队时延和分组丢失

> 交换机中具有输出缓存（output buffer ，也称作输出队列 output queue），用于存储路由器准备发往那条链路的分组。

> 如果在传输报文的过程中，而且这个链路传输分组时比较忙，已经到达的分组需要在输出缓存中等待还未到达的小伙伴们，就产生了排队时延(queuing delay)，和网络的拥塞程度有关，网络越通畅，排队的时间越短嘛，很好理解。

> 但是，有一个很难受的情况就是，输出缓存空间是有限的，万一排队的分组太多，就会出现分组丢失（丢包）(packet loss)。

##### 3.转发表和路由选择协议

> 前面提到，分组交换机通过一条链路连进来，又通过另外一条链路连出去，那么连的是哪条路呢，总不能随机分配吧。

> 在因特网中，每个端系统具有一个称为IP地址的地址。源主机在向目的端系统发送一个分组时，会在该分组的首部写上目的地的IP地址，路由器会检查目的地址的一部分，根据转发表(forwarding table)（每台路由器都会有）上地址和输出链路的映射关系，一旦发现这条路存在，就将其发送至这条路上。

> 那么转发表是如何配置的呐，书上告诉我说，因特网具有一些特殊的路由选择协议(routing protocol)，用于自动地设置这些转发表。其他的之后会提到，就先这样。
> 

#### 电路交换(circuit switching)

> 在端系统间通信会话期间，将会预留端系统之间沿路径通信需要的资源，包括缓存，链路传输速率。就像预约座位，虽然打电话预约需要前期一系列地沟通安排显得比较麻烦，但是显而易见，稳得不行。

![image.png](http://ww1.sinaimg.cn/large/00882iMuly1geeigprkq1j30y50bygnx.jpg)

> 复用技术可以使多个终端能够共享一条高速通道，从而达到节省信道资源的目的。

> 链路中电路主要时通过频分复用（FDM Frequency-Division Multiplexing)或时分复用(TDM Time-Division Multiplexing)实现。

> 频分制是将传输频带分为N部分，每个频段的宽度就是带宽(bandwidth),每个部分都可以作为一个独立的传输信道使用。

> 而时分制则是把一个传输信道进行时间分割，例如将N个设备连到一条公共的通道上，按一定次序轮流给各设备分配一段使用通道的时间。当轮到某设备时，接通设备与通道，其他设备此时被切断与通道的联系。直到使用时间间隔一道，则下一个开始。

##### 分组交换与电路交换的分析

> 分组交换与电路交换都是通过网络链路和交换机移动数据的方式。

> 在端系统间通信会话期间：

> 电路交换将会预留端系统间沿路径通信所需要的资源，包括缓存，链路和传输速率，而分组交换中却不会预留，资源将按需使用，就是你有多少，你用多少，但是有可能用的时候需要排队。

> 分组交换端到端时延是可变的和不可预测的（排队时延）。

> 分组交换提供比电路交换更好的带宽共享，比电路交换更加简单，更加有效，实现成本更低。分组交换按需分配链路使用，链路传输能力在所有需要在链路上传输分组的用户之间分组被共享。

> 虽然分组交换和电路交换在今天的电信网络中都是普遍采用的方式，但趋势是向着分组交换方向发展的。


